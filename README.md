# Применение: Отбор

**Платформа Revit:** Все  
**Версия Revit:** 2011.0  
**Первый выпуск:** 2011.0  
**Язык программирования:** C#  
**Уровень навыка:** Начальный  
**Категория:** Тип выбора  
**Тип команды:** Внешняя команда

## Тема: Избранные произведения

**Резюме:**  
Этот образец демонстрирует, как выполнять операции отбора в Revit.

---

### Классы:
- `Autodesk.Revit.UI.IExternalCommand`
- `Autodesk.Revit.DB.Document`
- `Autodesk.Revit.DB.Element`
- `Autodesk.Revit.DB.Reference`
- `Autodesk.Revit.UI.Selection.Selection`
- `Autodesk.Revit.UI.Selection.ObjectType`
- `Autodesk.Revit.UI.Selection.ISelectionFilter`
- `Autodesk.Revit.UI.Selection.ObjectSnapTypes`
- `Autodesk.Revit.Exceptions.OperationCanceledException`

---

### Файлы проекта:

#### **Command.cs**
Содержит четыре класса, реализующих интерфейс `IExternalCommand`:

1. **PickforDeletion**  
   Позволяет выбрать элементы и удалить их из документа.

2. **PlaceAtPointOnWallFace**  
   Позволяет выбрать точку на стене и установить окно размером 36" x 48".

3. **PlaceAtPickedFaceWorkplane**  
   Позволяет выбрать грань, установить на ней рабочую плоскость, выбрать точку на ней и создать круг с центром в этой точке.

4. **SelectionDialog**  
   Позволяет выбрать элемент и точку через диалог, после чего перемещает элемент в выбранную точку.

---

#### **SelectionFilters.cs**
Содержит три класса, реализующих интерфейс `ISelectionFilter`:

- **DefaultElementsFilter** — позволяет выбирать все объекты.
- **WallFaceFilter** — позволяет выбирать только грани стен.
- **PlanarFaceFilter** — позволяет выбирать только плоские грани.

---

#### **SelectionManager.cs**
Содержит два класса:

- **SelectionType** — предназначен для выбора конкретного типа выбора из диалога.
- **SelectionManager** — выполняет выбор и хранение объектов для диалога.

---

#### **SelectionForm.cs**
Содержит класс `SelectionForm`, который предоставляет диалоговое окно для выбора объектов.

---

### Описание:
В примере используются методы `PickObject` и `PickObjects` класса `Selection` для выбора одного и нескольких объектов, а также метод `PickPoint` для выбора точки.  
Элементы и ссылки фильтруются с помощью интерфейса `ISelectionFilter`.

---

### Инструкции:

1. Запустите Revit.
2. Откройте файл `SelectionsSample.rvt` или создайте проект с загруженным типом окна 36" x 48". Без этого типа окна команда `PlaceAtPointOnWallFace` не сработает.
3. Запустите команду **«Выбрать для удаления»** через внешнее командное меню. Выберите элементы — они будут удалены.
4. Запустите команду **«Разместить в точке на стене»**. Выберите точку на стене — на этом месте установится окно 36" x 48".
5. Запустите команду **«Поставить на выбранную рабочую плоскость»**. Выберите грань столбца — на ней создастся рабочая плоскость. Затем выберите точку на плоскости — создастся круг с центром в этой точке.
6. Запустите команду **«Диалог выбора»**. В диалоге нажмите **«Выбрать элемент»**, выберите элемент, затем нажмите **«Переместить к»** и выберите точку — элемент переместится в эту точку.
